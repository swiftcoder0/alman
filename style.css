:root {
  --glass-1: rgba(255,255,255,.14);
  --glass-2: rgba(255,255,255,.24);
  --white: #fff;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
html, body {
  height: 100%;
  font-family: "Poppins", system-ui, Segoe UI, Roboto, Arial;
  overflow: hidden;
}

/* Character-specific backgrounds */
body.teacher-bg { background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c); animation: gradientBG 15s ease infinite; background-size: 400% 400%; }
body.doctor-bg { background: linear-gradient(135deg, #0cebeb, #20e3b2, #0cebeb); animation: gradientBG 15s ease infinite; background-size: 400% 400%; }
body.stress-bg { background: linear-gradient(135deg, #ff7e5f, #feb47b, #ff7e5f); animation: gradientBG 15s ease infinite; background-size: 400% 400%; }
body.girl-bg { background: linear-gradient(135deg, #ff9a9e, #fad0c4, #ff9a9e); animation: gradientBG 15s ease infinite; background-size: 400% 400%; }
body.gpt-bg { background: linear-gradient(135deg, #1a1a1a, #2c2c2c, #1a1a1a); animation: gradientBG 15s ease infinite; background-size: 400% 400%; }
@keyframes gradientBG { 0%{background-position:0% 50%;} 50%{background-position:100% 50%;} 100%{background-position:0% 50%;} }

.bg {
  position: fixed; inset: 0; z-index: 0; overflow: hidden;
}
.bubble {
  position: absolute; bottom: -160px; border-radius: 50%; filter: blur(2px); animation: rise 22s linear infinite, wobble 7s ease-in-out infinite; box-shadow: 0 10px 30px rgba(0,0,0,.12);
}
.bubble:nth-child(1) { left:10%; width:220px; height:220px; animation-duration:26s;}
.bubble:nth-child(2) { left:28%; width:140px; height:140px; animation-duration:20s;}
.bubble:nth-child(3) { left:46%; width:180px; height:180px; animation-duration:24s;}
.bubble:nth-child(4) { left:65%; width:120px; height:120px; animation-duration:18s;}
.bubble:nth-child(5) { left:80%; width:260px; height:260px; animation-duration:28s;}
.bubble:nth-child(6) { left:5%; width:110px; height:110px; animation-duration:19s;}
.bubble:nth-child(7) { left:55%; width:95px; height:95px; animation-duration:17s;}
.bubble:nth-child(8) { left:75%; width:150px; height:150px; animation-duration:23s;}
@keyframes rise { 0%{transform:translateY(0) scale(1);opacity:.75;}50%{transform:translateY(-50vh) scale(1.08);opacity:1;}100%{transform:translateY(-110vh) scale(1);opacity:0;}}
@keyframes wobble {0%,100%{transform:translateX(0);}50%{transform:translateX(12px);}}

.topbar { position:fixed;top:12px;left:50%;transform:translateX(-50%);width:min(1100px,95vw);display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-radius:16px;background:var(--glass-1);border:1px solid var(--glass-2);backdrop-filter:blur(12px);z-index:4;}
.brand { display:flex;align-items:center;gap:10px;color:var(--white);font-weight:700;}
.orb { width: 14px; height: 14px; border-radius: 50%; background: linear-gradient(145deg, #ff2d95, #ffa6d4); box-shadow: 0 0 12px rgba(255,45,149,.6);}
.hamburger { width:40px;height:34px;border:none;background:transparent;cursor:pointer;display:grid;place-items:center;}
.hamburger span { display:block;width:22px;height:2px;background:var(--white);border-radius:2px;margin:3px 0;transition:.25s;}
.hamburger.active span:nth-child(1) { transform:translateY(5px) rotate(45deg);}
.hamburger.active span:nth-child(2) { opacity:0;}
.hamburger.active span:nth-child(3) { transform:translateY(-5px) rotate(-45deg);}
.persona-quick select {background:var(--glass-1);color:var(--white);border:1px solid var(--glass-2);border-radius:10px;padding:6px;}

.sidebar { position:fixed;top:0;left:0;height:100%;width:310px;transform:translateX(-120%) rotateY(18deg);transform-origin:left center;transition:transform .45s cubic-bezier(.2,.8,.2,1);z-index:5;}
.sidebar.open { transform:translateX(0) rotateY(0);}
.sidebar-inner { height:100%;padding:18px 16px 16px;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border-right:1px solid rgba(255,255,255,.12);backdrop-filter:blur(18px);}
.close-btn { position:absolute;right:14px;top:12px;background:transparent;border:none;color:var(--white);font-size:22px;cursor:pointer;}
.profile-card { display:flex;gap:12px;align-items:center;margin-top:64px;}
.avatar-3d { position:relative;width:56px;height:56px;border-radius:50%;display:grid;place-items:center;}
.avatar-3d img { width:52px;height:52px;border-radius:50%;border:2px solid rgba(255,255,255,.7);box-shadow:0 6px 18px rgba(0,0,0,.2);}
.avatar-3d .ring { position:absolute;inset:-6px;border-radius:50%;border:2px dashed rgba(255,255,255,.5);animation:spin 6s linear infinite;}
@keyframes spin { to { transform:rotate(360deg);} }
.profile-info h3 { color:var(--white);margin:0;}
.profile-info p { color:#ffe5f1;margin:.5px 0 0;}
.btn-outline { margin-left:auto;background:transparent;color:var(--white);border:1px solid rgba(255,255,255,.6);border-radius:10px;padding:6px 10px;cursor:pointer;}
.divider { height:1px;background:rgba(255,255,255,.15);margin:14px 0;}
.history-head { display:flex;align-items:center;justify-content:space-between;color:var(--white);}
.btn-mini { background:rgba(255,255,255,.06);color:var(--white);border:1px solid rgba(255,255,255,.12);border-radius:8px;padding:4px 8px;cursor:pointer;}
.history-list { list-style:none;margin:10px 0 0;padding:0;max-height:44vh;overflow:auto;}
.history-list li { color:var(--white);background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:8px 10px;margin-bottom:8px;cursor:pointer;transition:.12s;}
.history-list li:hover { transform:translateX(4px);}
.overlay { position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;z-index:3;}
.overlay.active { display:block;}
.main { position:fixed;inset:0;display:flex;align-items:flex-end;justify-content:center;padding:0 16px 18px;z-index:2;}
.chat { position:fixed;top:86px;left:50%;transform:translateX(-50%);width:min(600px,92vw);bottom:180px;display:flex;flex-direction:column;gap:10px;padding:12px;overflow-y:auto;}
body.sidebar-open .chat { left:calc(50% + 120px);}
.msg { max-width:72%;padding:10px 14px;border-radius:18px;line-height:1.45;color:var(--white);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);box-shadow:0 6px 14px rgba(0,0,0,.14);animation:pop .22s ease-out;word-wrap:break-word;}
@keyframes pop { from {opacity:0;transform:translateY(8px) scale(.98);}to {opacity:1;transform:translateY(0) scale(1);} }
.msg.bot {align-self:flex-start;border:1px solid rgba(255,255,255,.12);}
.msg.user {align-self:flex-end;background:rgba(255,45,149,0.46);border:1px solid rgba(255,255,255,.18);}
.msg.teacher{background:rgba(64,224,208,0.3);}
.msg.doctor{background:rgba(46,204,113,0.3);}
.msg.stress{background:rgba(241,196,15,0.3);}
.msg.girl{background:rgba(255,182,193,0.4);}
.msg.gpt{background:rgba(127,140,141,0.3);}
.typing { display:inline-block;min-width:36px;}
.dot {display:inline-block;width:6px;height:6px;margin:0 2px;background:var(--white);border-radius:50%;opacity:.8;animation:bounce 1s infinite;}
.dot:nth-child(2) {animation-delay:.15s;}
.dot:nth-child(3) {animation-delay:.3s;}
@keyframes bounce { 0%,80%,100%{transform:translateY(0);} 40%{transform:translateY(-5px);} }
.inputbar { position:fixed;left:50%;transform:translateX(-50%);bottom:20px;width:min(900px,92vw);display:flex;gap:10px;padding:12px;border-radius:28px;background:var(--glass-1);border:1px solid var(--glass-2);backdrop-filter:blur(12px);z-index:4;}
#msg { flex:1;background:transparent;color:var(--white);border:none;outline:none;font-size:15px;padding:6px 8px;}
#msg::placeholder { color:rgba(255,255,255,.85);}
.glow-btn { background:#ff2d95;color:var(--white);border:none;border-radius:22px;padding:10px 18px;cursor:pointer;font-weight:600;box-shadow:0 6px 16px rgba(255,45,149,.32);transition:transform .08s,box-shadow .2s;}
.glow-btn:hover { box-shadow:0 8px 20px rgba(255,45,149,.48);}
.glow-btn:active { transform:translateY(1px) scale(.98);}
@media (max-width: 820px){
  .sidebar{width:86vw;}
  body.sidebar-open .chat{left:50%;}
  .chat{bottom:160px;top:92px;}
}
.character-select { position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(10px);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:999;color:var(--white);text-align:center;}
.character-select h2 {font-size:24px;margin-bottom:20px;}
.characters {display:flex;flex-wrap:wrap;gap:20px;justify-content:center;}
.character { background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);border-radius:16px;padding:12px;width:130px;cursor:pointer;transition:transform 0.2s;}
.character img { border-radius:50%;width:100px;height:100px;}
.character:hover { transform:scale(1.08);background:rgba(255,255,255,0.2);}
